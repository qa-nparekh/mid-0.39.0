{"version":3,"file":"playwright\\ai-fixture.js","sources":["webpack://@sqaitech/web/webpack/runtime/define_property_getters","webpack://@sqaitech/web/webpack/runtime/has_own_property","webpack://@sqaitech/web/webpack/runtime/make_namespace_object","webpack://@sqaitech/web/./src/playwright/ai-fixture.ts"],"sourcesContent":["__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n            Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n        }\n    }\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { writeFileSync } from 'node:fs';\r\nimport { tmpdir } from 'node:os';\r\nimport { join } from 'node:path';\r\nimport { PlaywrightAgent, type PlaywrightWebPage } from '@/playwright/index';\r\nimport type { WebPageAgentOpt } from '@/web-element';\r\nimport type { Cache } from '@sqaitech/core';\r\nimport type { AgentOpt, Agent as PageAgent } from '@sqaitech/core/agent';\r\nimport { processCacheConfig } from '@sqaitech/core/utils';\r\nimport {\r\n  DEFAULT_WAIT_FOR_NAVIGATION_TIMEOUT,\r\n  DEFAULT_WAIT_FOR_NETWORK_IDLE_TIMEOUT,\r\n} from '@sqaitech/shared/constants';\r\nimport { getDebug } from '@sqaitech/shared/logger';\r\nimport { uuid } from '@sqaitech/shared/utils';\r\nimport { replaceIllegalPathCharsAndSpace } from '@sqaitech/shared/utils';\r\nimport { type TestInfo, type TestType, test } from '@playwright/test';\r\nimport type { Page as OriginPlaywrightPage } from 'playwright';\r\nexport type APITestType = Pick<TestType<any, any>, 'step'>;\r\n\r\nconst debugPage = getDebug('web:playwright:ai-fixture');\r\n\r\nconst groupAndCaseForTest = (testInfo: TestInfo) => {\r\n  let taskFile: string;\r\n  let taskTitle: string;\r\n  const titlePath = [...testInfo.titlePath];\r\n\r\n  if (titlePath.length > 1) {\r\n    taskFile = titlePath.shift() || 'unnamed';\r\n    taskTitle = titlePath.join('__');\r\n  } else if (titlePath.length === 1) {\r\n    taskTitle = titlePath[0];\r\n    taskFile = `${taskTitle}`;\r\n  } else {\r\n    taskTitle = 'unnamed';\r\n    taskFile = 'unnamed';\r\n  }\r\n\r\n  const taskTitleWithRetry = `${taskTitle}${testInfo.retry ? `(retry #${testInfo.retry})` : ''}`;\r\n\r\n  return {\r\n    file: taskFile,\r\n    id: replaceIllegalPathCharsAndSpace(`${taskFile}(${taskTitle})`),\r\n    title: replaceIllegalPathCharsAndSpace(taskTitleWithRetry),\r\n  };\r\n};\r\n\r\nconst midsceneAgentKeyId = '_midsceneAgentId';\r\nexport const midsceneDumpAnnotationId = 'MIDSCENE_DUMP_ANNOTATION';\r\n\r\ntype PlaywrightCacheConfig = {\r\n  strategy?: 'read-only' | 'read-write' | 'write-only';\r\n  id?: string;\r\n};\r\ntype PlaywrightCache = false | true | PlaywrightCacheConfig;\r\n\r\nexport const PlaywrightAiFixture = (options?: {\r\n  forceSameTabNavigation?: boolean;\r\n  waitForNetworkIdleTimeout?: number;\r\n  waitForNavigationTimeout?: number;\r\n  cache?: PlaywrightCache;\r\n}) => {\r\n  const {\r\n    forceSameTabNavigation = true,\r\n    waitForNetworkIdleTimeout = DEFAULT_WAIT_FOR_NETWORK_IDLE_TIMEOUT,\r\n    waitForNavigationTimeout = DEFAULT_WAIT_FOR_NAVIGATION_TIMEOUT,\r\n    cache,\r\n  } = options ?? {};\r\n\r\n  // Helper function to process cache configuration and auto-generate ID from test info\r\n  const processTestCacheConfig = (testInfo: TestInfo): Cache | undefined => {\r\n    // Generate ID from test info\r\n    const { id } = groupAndCaseForTest(testInfo);\r\n\r\n    // Use shared processCacheConfig with generated ID as fallback\r\n    return processCacheConfig(cache as Cache, id);\r\n  };\r\n\r\n  const pageAgentMap: Record<string, PageAgent<PlaywrightWebPage>> = {};\r\n  const createOrReuseAgentForPage = (\r\n    page: OriginPlaywrightPage,\r\n    testInfo: TestInfo, // { testId: string; taskFile: string; taskTitle: string },\r\n    opts?: WebPageAgentOpt,\r\n  ) => {\r\n    let idForPage = (page as any)[midsceneAgentKeyId];\r\n    if (!idForPage) {\r\n      idForPage = uuid();\r\n      (page as any)[midsceneAgentKeyId] = idForPage;\r\n      const { testId } = testInfo;\r\n      const { file, title } = groupAndCaseForTest(testInfo);\r\n      const cacheConfig = processTestCacheConfig(testInfo);\r\n\r\n      pageAgentMap[idForPage] = new PlaywrightAgent(page, {\r\n        testId: `playwright-${testId}-${idForPage}`,\r\n        forceSameTabNavigation,\r\n        cache: cacheConfig,\r\n        groupName: title,\r\n        groupDescription: file,\r\n        generateReport: false, // we will generate it in the reporter\r\n        ...opts,\r\n      });\r\n\r\n      pageAgentMap[idForPage].onDumpUpdate = (dump: string) => {\r\n        updateDumpAnnotation(testInfo, dump);\r\n      };\r\n\r\n      page.on('close', () => {\r\n        debugPage('page closed');\r\n        pageAgentMap[idForPage].destroy();\r\n        delete pageAgentMap[idForPage];\r\n      });\r\n    }\r\n\r\n    return pageAgentMap[idForPage];\r\n  };\r\n\r\n  async function generateAiFunction(options: {\r\n    page: OriginPlaywrightPage;\r\n    testInfo: TestInfo;\r\n    use: any;\r\n    aiActionType:\r\n      | 'ai'\r\n      | 'aiAction'\r\n      | 'aiHover'\r\n      | 'aiInput'\r\n      | 'aiKeyboardPress'\r\n      | 'aiScroll'\r\n      | 'aiTap'\r\n      | 'aiRightClick'\r\n      | 'aiDoubleClick'\r\n      | 'aiQuery'\r\n      | 'aiAssert'\r\n      | 'aiWaitFor'\r\n      | 'aiLocate'\r\n      | 'aiNumber'\r\n      | 'aiString'\r\n      | 'aiBoolean'\r\n      | 'aiAsk'\r\n      | 'runYaml'\r\n      | 'setAIActionContext'\r\n      | 'evaluateJavaScript'\r\n      | 'logScreenshot'\r\n      | 'freezePageContext'\r\n      | 'unfreezePageContext';\r\n  }) {\r\n    const { page, testInfo, use, aiActionType } = options;\r\n    const agent = createOrReuseAgentForPage(page, testInfo, {\r\n      waitForNavigationTimeout,\r\n      waitForNetworkIdleTimeout,\r\n    }) as PlaywrightAgent;\r\n\r\n    await use(async (taskPrompt: string, ...args: any[]) => {\r\n      return new Promise((resolve, reject) => {\r\n        test.step(`ai-${aiActionType} - ${JSON.stringify(taskPrompt)}`, async () => {\r\n          try {\r\n            debugPage(\r\n              `waitForNetworkIdle timeout: ${waitForNetworkIdleTimeout}`,\r\n            );\r\n            await agent.waitForNetworkIdle(waitForNetworkIdleTimeout);\r\n          } catch (error) {\r\n            console.warn(\r\n              '[midscene:warning] Waiting for network idle has timed out, but Midscene will continue execution. Please check https://midscenejs.com/faq.html#customize-the-network-timeout for more information on customizing the network timeout',\r\n            );\r\n          }\r\n          try {\r\n            type AgentMethod = (\r\n              prompt: string,\r\n              ...restArgs: any[]\r\n            ) => Promise<any>;\r\n            const result = await (agent[aiActionType] as AgentMethod)(\r\n              taskPrompt,\r\n              ...(args || []),\r\n            );\r\n            resolve(result);\r\n          } catch (error) {\r\n            reject(error);\r\n          }\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  const updateDumpAnnotation = (test: TestInfo, dump: string) => {\r\n    // Write dump to temporary file\r\n    const tempFileName = `midscene-dump-${test.testId || uuid()}-${Date.now()}.json`;\r\n    const tempFilePath = join(tmpdir(), tempFileName);\r\n\r\n    writeFileSync(tempFilePath, dump, 'utf-8');\r\n    debugPage(`Dump written to temp file: ${tempFilePath}`);\r\n\r\n    // Store only the file path in annotation\r\n    const currentAnnotation = test.annotations.find((item) => {\r\n      return item.type === midsceneDumpAnnotationId;\r\n    });\r\n    if (currentAnnotation) {\r\n      // Store file path instead of dump content\r\n      currentAnnotation.description = tempFilePath;\r\n    } else {\r\n      test.annotations.push({\r\n        type: midsceneDumpAnnotationId,\r\n        description: tempFilePath,\r\n      });\r\n    }\r\n  };\r\n\r\n  return {\r\n    agentForPage: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await use(\r\n        async (\r\n          propsPage?: OriginPlaywrightPage | undefined,\r\n          opts?: AgentOpt,\r\n        ) => {\r\n          const cacheConfig = processTestCacheConfig(testInfo);\r\n\r\n          // Handle cache configuration priority:\r\n          // 1. If user provides cache in opts, use it (but auto-generate ID if missing)\r\n          // 2. Otherwise use fixture's cache config\r\n          let finalCacheConfig = cacheConfig;\r\n          if (opts?.cache !== undefined) {\r\n            const userCache = opts.cache;\r\n            if (userCache === false) {\r\n              finalCacheConfig = false;\r\n            } else if (userCache === true) {\r\n              // Auto-generate ID for user's cache: true\r\n              const { id } = groupAndCaseForTest(testInfo);\r\n              finalCacheConfig = { id };\r\n            } else if (typeof userCache === 'object') {\r\n              if (!userCache.id) {\r\n                // Auto-generate ID for user's cache object without ID\r\n                const { id } = groupAndCaseForTest(testInfo);\r\n                finalCacheConfig = { ...userCache, id };\r\n              } else {\r\n                finalCacheConfig = userCache;\r\n              }\r\n            }\r\n          }\r\n\r\n          const agent = createOrReuseAgentForPage(propsPage || page, testInfo, {\r\n            waitForNavigationTimeout,\r\n            waitForNetworkIdleTimeout,\r\n            cache: finalCacheConfig,\r\n            ...opts,\r\n          });\r\n          return agent;\r\n        },\r\n      );\r\n    },\r\n    ai: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'ai',\r\n      });\r\n    },\r\n    aiAction: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiAction',\r\n      });\r\n    },\r\n    aiTap: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiTap',\r\n      });\r\n    },\r\n    aiRightClick: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiRightClick',\r\n      });\r\n    },\r\n    aiDoubleClick: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiDoubleClick',\r\n      });\r\n    },\r\n    aiHover: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiHover',\r\n      });\r\n    },\r\n    aiInput: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiInput',\r\n      });\r\n    },\r\n    aiKeyboardPress: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiKeyboardPress',\r\n      });\r\n    },\r\n    aiScroll: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiScroll',\r\n      });\r\n    },\r\n    aiQuery: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiQuery',\r\n      });\r\n    },\r\n    aiAssert: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiAssert',\r\n      });\r\n    },\r\n    aiWaitFor: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiWaitFor',\r\n      });\r\n    },\r\n    aiLocate: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiLocate',\r\n      });\r\n    },\r\n    aiNumber: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiNumber',\r\n      });\r\n    },\r\n    aiString: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiString',\r\n      });\r\n    },\r\n    aiBoolean: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiBoolean',\r\n      });\r\n    },\r\n    aiAsk: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'aiAsk',\r\n      });\r\n    },\r\n    runYaml: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'runYaml',\r\n      });\r\n    },\r\n    setAIActionContext: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'setAIActionContext',\r\n      });\r\n    },\r\n    evaluateJavaScript: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'evaluateJavaScript',\r\n      });\r\n    },\r\n    logScreenshot: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'logScreenshot',\r\n      });\r\n    },\r\n    freezePageContext: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'freezePageContext',\r\n      });\r\n    },\r\n    unfreezePageContext: async (\r\n      { page }: { page: OriginPlaywrightPage },\r\n      use: any,\r\n      testInfo: TestInfo,\r\n    ) => {\r\n      await generateAiFunction({\r\n        page,\r\n        testInfo,\r\n        use,\r\n        aiActionType: 'unfreezePageContext',\r\n      });\r\n    },\r\n  };\r\n};\r\n\r\nexport type PlayWrightAiFixtureType = {\r\n  agentForPage: (\r\n    page?: any,\r\n    opts?: any,\r\n  ) => Promise<PageAgent<PlaywrightWebPage>>;\r\n  ai: <T = any>(prompt: string) => Promise<T>;\r\n  aiAction: (taskPrompt: string) => ReturnType<PageAgent['aiAction']>;\r\n  aiTap: (\r\n    ...args: Parameters<PageAgent['aiTap']>\r\n  ) => ReturnType<PageAgent['aiTap']>;\r\n  aiRightClick: (\r\n    ...args: Parameters<PageAgent['aiRightClick']>\r\n  ) => ReturnType<PageAgent['aiRightClick']>;\r\n  aiDoubleClick: (\r\n    ...args: Parameters<PageAgent['aiDoubleClick']>\r\n  ) => ReturnType<PageAgent['aiDoubleClick']>;\r\n  aiHover: (\r\n    ...args: Parameters<PageAgent['aiHover']>\r\n  ) => ReturnType<PageAgent['aiHover']>;\r\n  aiInput: (\r\n    ...args: Parameters<PageAgent['aiInput']>\r\n  ) => ReturnType<PageAgent['aiInput']>;\r\n  aiKeyboardPress: (\r\n    ...args: Parameters<PageAgent['aiKeyboardPress']>\r\n  ) => ReturnType<PageAgent['aiKeyboardPress']>;\r\n  aiScroll: (\r\n    ...args: Parameters<PageAgent['aiScroll']>\r\n  ) => ReturnType<PageAgent['aiScroll']>;\r\n  aiQuery: <T = any>(...args: Parameters<PageAgent['aiQuery']>) => Promise<T>;\r\n  aiAssert: (\r\n    ...args: Parameters<PageAgent['aiAssert']>\r\n  ) => ReturnType<PageAgent['aiAssert']>;\r\n  aiWaitFor: (...args: Parameters<PageAgent['aiWaitFor']>) => Promise<void>;\r\n  aiLocate: (\r\n    ...args: Parameters<PageAgent['aiLocate']>\r\n  ) => ReturnType<PageAgent['aiLocate']>;\r\n  aiNumber: (\r\n    ...args: Parameters<PageAgent['aiNumber']>\r\n  ) => ReturnType<PageAgent['aiNumber']>;\r\n  aiString: (\r\n    ...args: Parameters<PageAgent['aiString']>\r\n  ) => ReturnType<PageAgent['aiString']>;\r\n  aiBoolean: (\r\n    ...args: Parameters<PageAgent['aiBoolean']>\r\n  ) => ReturnType<PageAgent['aiBoolean']>;\r\n  aiAsk: (\r\n    ...args: Parameters<PageAgent['aiAsk']>\r\n  ) => ReturnType<PageAgent['aiAsk']>;\r\n  runYaml: (\r\n    ...args: Parameters<PageAgent['runYaml']>\r\n  ) => ReturnType<PageAgent['runYaml']>;\r\n  setAIActionContext: (\r\n    ...args: Parameters<PageAgent['setAIActionContext']>\r\n  ) => ReturnType<PageAgent['setAIActionContext']>;\r\n  evaluateJavaScript: (\r\n    ...args: Parameters<PageAgent['evaluateJavaScript']>\r\n  ) => ReturnType<PageAgent['evaluateJavaScript']>;\r\n  logScreenshot: (\r\n    ...args: Parameters<PageAgent['logScreenshot']>\r\n  ) => ReturnType<PageAgent['logScreenshot']>;\r\n  freezePageContext: (\r\n    ...args: Parameters<PageAgent['freezePageContext']>\r\n  ) => ReturnType<PageAgent['freezePageContext']>;\r\n  unfreezePageContext: (\r\n    ...args: Parameters<PageAgent['unfreezePageContext']>\r\n  ) => ReturnType<PageAgent['unfreezePageContext']>;\r\n};\r\n"],"names":["__webpack_require__","definition","key","Object","obj","prop","Symbol","debugPage","getDebug","groupAndCaseForTest","testInfo","taskFile","taskTitle","titlePath","taskTitleWithRetry","replaceIllegalPathCharsAndSpace","midsceneAgentKeyId","midsceneDumpAnnotationId","PlaywrightAiFixture","options","forceSameTabNavigation","waitForNetworkIdleTimeout","DEFAULT_WAIT_FOR_NETWORK_IDLE_TIMEOUT","waitForNavigationTimeout","DEFAULT_WAIT_FOR_NAVIGATION_TIMEOUT","cache","processTestCacheConfig","id","processCacheConfig","pageAgentMap","createOrReuseAgentForPage","page","opts","idForPage","uuid","testId","file","title","cacheConfig","PlaywrightAgent","dump","updateDumpAnnotation","generateAiFunction","use","aiActionType","agent","taskPrompt","args","Promise","resolve","reject","test","JSON","error","console","result","tempFileName","Date","tempFilePath","join","tmpdir","writeFileSync","currentAnnotation","item","propsPage","finalCacheConfig","undefined","userCache"],"mappings":"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ACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,UAAU,OACR,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,SAAS,OACP,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,UAAU,OACR,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,WAAW,OACT,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,UAAU,OACR,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,UAAU,OACR,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,UAAU,OACR,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,WAAW,OACT,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,OAAO,OACL,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,SAAS,OACP,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,oBAAoB,OAClB,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,oBAAoB,OAClB,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,eAAe,OACb,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,mBAAmB,OACjB,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;QACA,qBAAqB,OACnB,EAAEZ,IAAI,EAAkC,EACxCY,KACAjC;YAEA,MAAMgC,mBAAmB;gBACvBX;gBACArB;gBACAiC;gBACA,cAAc;YAChB;QACF;IACF;AACF"}