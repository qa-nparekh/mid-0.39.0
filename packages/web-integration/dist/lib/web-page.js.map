{"version":3,"file":"web-page.js","sources":["webpack://@sqaitech/web/webpack/runtime/compat_get_default_export","webpack://@sqaitech/web/webpack/runtime/define_property_getters","webpack://@sqaitech/web/webpack/runtime/has_own_property","webpack://@sqaitech/web/webpack/runtime/make_namespace_object","webpack://@sqaitech/web/./src/web-page.ts"],"sourcesContent":["// getDefaultExport function for compatibility with non-ESM modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};\n","__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n            Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n        }\n    }\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import assert from 'node:assert';\r\nimport type { Point } from '@sqaitech/core';\r\nimport {\r\n  AbstractInterface,\r\n  type DeviceAction,\r\n  defineActionClearInput,\r\n  defineActionDoubleClick,\r\n  defineActionDragAndDrop,\r\n  defineActionHover,\r\n  defineActionInput,\r\n  defineActionKeyboardPress,\r\n  defineActionLongPress,\r\n  defineActionRightClick,\r\n  defineActionScroll,\r\n  defineActionSwipe,\r\n  defineActionTap,\r\n} from '@sqaitech/core/device';\r\n\r\nimport { sleep } from '@sqaitech/core/utils';\r\nimport type { ElementInfo } from '@sqaitech/shared/extractor';\r\nimport { getDebug } from '@sqaitech/shared/logger';\r\nimport { transformHotkeyInput } from '@sqaitech/shared/us-keyboard-layout';\r\n\r\nconst debug = getDebug('web:page');\r\n\r\nfunction normalizeKeyInputs(value: string | string[]): string[] {\r\n  const inputs = Array.isArray(value) ? value : [value];\r\n  const result: string[] = [];\r\n\r\n  for (const input of inputs) {\r\n    if (typeof input !== 'string') {\r\n      result.push(input as unknown as string);\r\n      continue;\r\n    }\r\n\r\n    const trimmed = input.trim();\r\n    if (!trimmed) {\r\n      result.push(input);\r\n      continue;\r\n    }\r\n\r\n    let normalized = trimmed;\r\n    if (normalized.length > 1 && normalized.includes('+')) {\r\n      normalized = normalized.replace(/\\s*\\+\\s*/g, ' ');\r\n    }\r\n    if (/\\s/.test(normalized)) {\r\n      normalized = normalized.replace(/\\s+/g, ' ');\r\n    }\r\n\r\n    const transformed = transformHotkeyInput(normalized);\r\n    if (transformed.length === 1 && transformed[0] === '' && trimmed !== '') {\r\n      result.push(input);\r\n      continue;\r\n    }\r\n    if (transformed.length === 0) {\r\n      result.push(input);\r\n      continue;\r\n    }\r\n\r\n    result.push(...transformed);\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nexport function getKeyCommands(\r\n  value: string | string[],\r\n): Array<{ key: string; command?: string }> {\r\n  const keys = normalizeKeyInputs(value);\r\n\r\n  return keys.reduce((acc: Array<{ key: string; command?: string }>, k) => {\r\n    const includeMeta = keys.includes('Meta') || keys.includes('Control');\r\n    if (includeMeta && (k === 'a' || k === 'A')) {\r\n      return acc.concat([{ key: k, command: 'SelectAll' }]);\r\n    }\r\n    if (includeMeta && (k === 'c' || k === 'C')) {\r\n      return acc.concat([{ key: k, command: 'Copy' }]);\r\n    }\r\n    if (includeMeta && (k === 'v' || k === 'V')) {\r\n      return acc.concat([{ key: k, command: 'Paste' }]);\r\n    }\r\n    return acc.concat([{ key: k }]);\r\n  }, []);\r\n}\r\n\r\n// this is copied from puppeteer, but we don't want to import puppeteer here\r\nexport declare type KeyInput =\r\n  | '0'\r\n  | '1'\r\n  | '2'\r\n  | '3'\r\n  | '4'\r\n  | '5'\r\n  | '6'\r\n  | '7'\r\n  | '8'\r\n  | '9'\r\n  | 'Power'\r\n  | 'Eject'\r\n  | 'Abort'\r\n  | 'Help'\r\n  | 'Backspace'\r\n  | 'Tab'\r\n  | 'Numpad5'\r\n  | 'NumpadEnter'\r\n  | 'Enter'\r\n  | '\\r'\r\n  | '\\n'\r\n  | 'ShiftLeft'\r\n  | 'ShiftRight'\r\n  | 'ControlLeft'\r\n  | 'ControlRight'\r\n  | 'AltLeft'\r\n  | 'AltRight'\r\n  | 'Pause'\r\n  | 'CapsLock'\r\n  | 'Escape'\r\n  | 'Convert'\r\n  | 'NonConvert'\r\n  | 'Space'\r\n  | 'Numpad9'\r\n  | 'PageUp'\r\n  | 'Numpad3'\r\n  | 'PageDown'\r\n  | 'End'\r\n  | 'Numpad1'\r\n  | 'Home'\r\n  | 'Numpad7'\r\n  | 'ArrowLeft'\r\n  | 'Numpad4'\r\n  | 'Numpad8'\r\n  | 'ArrowUp'\r\n  | 'ArrowRight'\r\n  | 'Numpad6'\r\n  | 'Numpad2'\r\n  | 'ArrowDown'\r\n  | 'Select'\r\n  | 'Open'\r\n  | 'PrintScreen'\r\n  | 'Insert'\r\n  | 'Numpad0'\r\n  | 'Delete'\r\n  | 'NumpadDecimal'\r\n  | 'Digit0'\r\n  | 'Digit1'\r\n  | 'Digit2'\r\n  | 'Digit3'\r\n  | 'Digit4'\r\n  | 'Digit5'\r\n  | 'Digit6'\r\n  | 'Digit7'\r\n  | 'Digit8'\r\n  | 'Digit9'\r\n  | 'KeyA'\r\n  | 'KeyB'\r\n  | 'KeyC'\r\n  | 'KeyD'\r\n  | 'KeyE'\r\n  | 'KeyF'\r\n  | 'KeyG'\r\n  | 'KeyH'\r\n  | 'KeyI'\r\n  | 'KeyJ'\r\n  | 'KeyK'\r\n  | 'KeyL'\r\n  | 'KeyM'\r\n  | 'KeyN'\r\n  | 'KeyO'\r\n  | 'KeyP'\r\n  | 'KeyQ'\r\n  | 'KeyR'\r\n  | 'KeyS'\r\n  | 'KeyT'\r\n  | 'KeyU'\r\n  | 'KeyV'\r\n  | 'KeyW'\r\n  | 'KeyX'\r\n  | 'KeyY'\r\n  | 'KeyZ'\r\n  | 'MetaLeft'\r\n  | 'MetaRight'\r\n  | 'ContextMenu'\r\n  | 'NumpadMultiply'\r\n  | 'NumpadAdd'\r\n  | 'NumpadSubtract'\r\n  | 'NumpadDivide'\r\n  | 'F1'\r\n  | 'F2'\r\n  | 'F3'\r\n  | 'F4'\r\n  | 'F5'\r\n  | 'F6'\r\n  | 'F7'\r\n  | 'F8'\r\n  | 'F9'\r\n  | 'F10'\r\n  | 'F11'\r\n  | 'F12'\r\n  | 'F13'\r\n  | 'F14'\r\n  | 'F15'\r\n  | 'F16'\r\n  | 'F17'\r\n  | 'F18'\r\n  | 'F19'\r\n  | 'F20'\r\n  | 'F21'\r\n  | 'F22'\r\n  | 'F23'\r\n  | 'F24'\r\n  | 'NumLock'\r\n  | 'ScrollLock'\r\n  | 'AudioVolumeMute'\r\n  | 'AudioVolumeDown'\r\n  | 'AudioVolumeUp'\r\n  | 'MediaTrackNext'\r\n  | 'MediaTrackPrevious'\r\n  | 'MediaStop'\r\n  | 'MediaPlayPause'\r\n  | 'Semicolon'\r\n  | 'Equal'\r\n  | 'NumpadEqual'\r\n  | 'Comma'\r\n  | 'Minus'\r\n  | 'Period'\r\n  | 'Slash'\r\n  | 'Backquote'\r\n  | 'BracketLeft'\r\n  | 'Backslash'\r\n  | 'BracketRight'\r\n  | 'Quote'\r\n  | 'AltGraph'\r\n  | 'Props'\r\n  | 'Cancel'\r\n  | 'Clear'\r\n  | 'Shift'\r\n  | 'Control'\r\n  | 'Alt'\r\n  | 'Accept'\r\n  | 'ModeChange'\r\n  | ' '\r\n  | 'Print'\r\n  | 'Execute'\r\n  | '\\u0000'\r\n  | 'a'\r\n  | 'b'\r\n  | 'c'\r\n  | 'd'\r\n  | 'e'\r\n  | 'f'\r\n  | 'g'\r\n  | 'h'\r\n  | 'i'\r\n  | 'j'\r\n  | 'k'\r\n  | 'l'\r\n  | 'm'\r\n  | 'n'\r\n  | 'o'\r\n  | 'p'\r\n  | 'q'\r\n  | 'r'\r\n  | 's'\r\n  | 't'\r\n  | 'u'\r\n  | 'v'\r\n  | 'w'\r\n  | 'x'\r\n  | 'y'\r\n  | 'z'\r\n  | 'Meta'\r\n  | '*'\r\n  | '+'\r\n  | '-'\r\n  | '/'\r\n  | ';'\r\n  | '='\r\n  | ','\r\n  | '.'\r\n  | '`'\r\n  | '['\r\n  | '\\\\'\r\n  | ']'\r\n  | \"'\"\r\n  | 'Attn'\r\n  | 'CrSel'\r\n  | 'ExSel'\r\n  | 'EraseEof'\r\n  | 'Play'\r\n  | 'ZoomOut'\r\n  | ')'\r\n  | '!'\r\n  | '@'\r\n  | '#'\r\n  | '$'\r\n  | '%'\r\n  | '^'\r\n  | '&'\r\n  | '('\r\n  | 'A'\r\n  | 'B'\r\n  | 'C'\r\n  | 'D'\r\n  | 'E'\r\n  | 'F'\r\n  | 'G'\r\n  | 'H'\r\n  | 'I'\r\n  | 'J'\r\n  | 'K'\r\n  | 'L'\r\n  | 'M'\r\n  | 'N'\r\n  | 'O'\r\n  | 'P'\r\n  | 'Q'\r\n  | 'R'\r\n  | 'S'\r\n  | 'T'\r\n  | 'U'\r\n  | 'V'\r\n  | 'W'\r\n  | 'X'\r\n  | 'Y'\r\n  | 'Z'\r\n  | ':'\r\n  | '<'\r\n  | '_'\r\n  | '>'\r\n  | '?'\r\n  | '~'\r\n  | '{'\r\n  | '|'\r\n  | '}'\r\n  | '\"'\r\n  | 'SoftLeft'\r\n  | 'SoftRight'\r\n  | 'Camera'\r\n  | 'Call'\r\n  | 'EndCall'\r\n  | 'VolumeDown'\r\n  | 'VolumeUp';\r\n\r\nexport type MouseButton = 'left' | 'right' | 'middle';\r\n\r\nexport interface MouseAction {\r\n  click: (\r\n    x: number,\r\n    y: number,\r\n    options: { button: MouseButton; count?: number },\r\n  ) => Promise<void>;\r\n  wheel: (deltaX: number, deltaY: number) => Promise<void>;\r\n  move: (x: number, y: number) => Promise<void>;\r\n  drag: (\r\n    from: { x: number; y: number },\r\n    to: { x: number; y: number },\r\n  ) => Promise<void>;\r\n}\r\n\r\nexport interface KeyboardAction {\r\n  type: (text: string) => Promise<void>;\r\n  press: (\r\n    action:\r\n      | { key: KeyInput; command?: string }\r\n      | { key: KeyInput; command?: string }[],\r\n  ) => Promise<void>;\r\n}\r\n\r\nexport interface ChromePageDestroyOptions {\r\n  closeTab?: boolean; // should close the tab when the page object is destroyed\r\n}\r\n\r\nexport abstract class AbstractWebPage extends AbstractInterface {\r\n  get mouse(): MouseAction {\r\n    return {\r\n      click: async (\r\n        x: number,\r\n        y: number,\r\n        options: { button: MouseButton },\r\n      ) => {},\r\n      wheel: async (deltaX: number, deltaY: number) => {},\r\n      move: async (x: number, y: number) => {},\r\n      drag: async (\r\n        from: { x: number; y: number },\r\n        to: { x: number; y: number },\r\n      ) => {},\r\n    };\r\n  }\r\n\r\n  get keyboard(): KeyboardAction {\r\n    return {\r\n      type: async (text: string) => {},\r\n      press: async (\r\n        action:\r\n          | { key: KeyInput; command?: string }\r\n          | { key: KeyInput; command?: string }[],\r\n      ) => {},\r\n    };\r\n  }\r\n\r\n  async clearInput(element: ElementInfo): Promise<void> {}\r\n\r\n  abstract scrollUntilTop(startingPoint?: Point): Promise<void>;\r\n  abstract scrollUntilBottom(startingPoint?: Point): Promise<void>;\r\n  abstract scrollUntilLeft(startingPoint?: Point): Promise<void>;\r\n  abstract scrollUntilRight(startingPoint?: Point): Promise<void>;\r\n  abstract scrollUp(distance?: number, startingPoint?: Point): Promise<void>;\r\n  abstract scrollDown(distance?: number, startingPoint?: Point): Promise<void>;\r\n  abstract scrollLeft(distance?: number, startingPoint?: Point): Promise<void>;\r\n  abstract scrollRight(distance?: number, startingPoint?: Point): Promise<void>;\r\n  abstract longPress(x: number, y: number, duration?: number): Promise<void>;\r\n  abstract swipe(\r\n    from: { x: number; y: number },\r\n    to: { x: number; y: number },\r\n    duration?: number,\r\n  ): Promise<void>;\r\n}\r\n\r\nexport const commonWebActionsForWebPage = <T extends AbstractWebPage>(\r\n  page: T,\r\n): DeviceAction<any>[] => [\r\n  defineActionTap(async (param) => {\r\n    const element = param.locate;\r\n    assert(element, 'Element not found, cannot tap');\r\n    await page.mouse.click(element.center[0], element.center[1], {\r\n      button: 'left',\r\n    });\r\n  }),\r\n  defineActionRightClick(async (param) => {\r\n    const element = param.locate;\r\n    assert(element, 'Element not found, cannot right click');\r\n    await page.mouse.click(element.center[0], element.center[1], {\r\n      button: 'right',\r\n    });\r\n  }),\r\n  defineActionDoubleClick(async (param) => {\r\n    const element = param.locate;\r\n    assert(element, 'Element not found, cannot double click');\r\n\r\n    await page.mouse.click(element.center[0], element.center[1], {\r\n      button: 'left',\r\n      count: 2,\r\n    });\r\n  }),\r\n  defineActionHover(async (param) => {\r\n    const element = param.locate;\r\n    assert(element, 'Element not found, cannot hover');\r\n    await page.mouse.move(element.center[0], element.center[1]);\r\n  }),\r\n  defineActionInput(async (param) => {\r\n    const element = param.locate;\r\n    if (element && param.mode !== 'append') {\r\n      await page.clearInput(element as unknown as ElementInfo);\r\n    }\r\n\r\n    if (param.mode === 'clear') {\r\n      // Clear mode removes existing text without entering new characters\r\n      return;\r\n    }\r\n\r\n    if (!param || !param.value) {\r\n      return;\r\n    }\r\n\r\n    // Note: there is another implementation in AndroidDevicePage, which is more complex\r\n    await page.keyboard.type(param.value);\r\n  }),\r\n  defineActionKeyboardPress(async (param) => {\r\n    const element = param.locate;\r\n    if (element) {\r\n      await page.mouse.click(element.center[0], element.center[1], {\r\n        button: 'left',\r\n      });\r\n    }\r\n\r\n    const keys = getKeyCommands(param.keyName);\r\n    await page.keyboard.press(keys as any); // TODO: fix this type error\r\n  }),\r\n  defineActionScroll(async (param) => {\r\n    const element = param.locate;\r\n    const startingPoint = element\r\n      ? {\r\n          left: element.center[0],\r\n          top: element.center[1],\r\n        }\r\n      : undefined;\r\n    const scrollToEventName = param?.scrollType;\r\n    if (scrollToEventName === 'untilTop') {\r\n      await page.scrollUntilTop(startingPoint);\r\n    } else if (scrollToEventName === 'untilBottom') {\r\n      await page.scrollUntilBottom(startingPoint);\r\n    } else if (scrollToEventName === 'untilRight') {\r\n      await page.scrollUntilRight(startingPoint);\r\n    } else if (scrollToEventName === 'untilLeft') {\r\n      await page.scrollUntilLeft(startingPoint);\r\n    } else if (scrollToEventName === 'once' || !scrollToEventName) {\r\n      if (param?.direction === 'down' || !param || !param.direction) {\r\n        await page.scrollDown(param?.distance || undefined, startingPoint);\r\n      } else if (param.direction === 'up') {\r\n        await page.scrollUp(param.distance || undefined, startingPoint);\r\n      } else if (param.direction === 'left') {\r\n        await page.scrollLeft(param.distance || undefined, startingPoint);\r\n      } else if (param.direction === 'right') {\r\n        await page.scrollRight(param.distance || undefined, startingPoint);\r\n      } else {\r\n        throw new Error(`Unknown scroll direction: ${param.direction}`);\r\n      }\r\n      // until mouse event is done\r\n      await sleep(500);\r\n    } else {\r\n      throw new Error(\r\n        `Unknown scroll event type: ${scrollToEventName}, param: ${JSON.stringify(\r\n          param,\r\n        )}`,\r\n      );\r\n    }\r\n  }),\r\n  defineActionDragAndDrop(async (param) => {\r\n    const from = param.from;\r\n    const to = param.to;\r\n    assert(from, 'missing \"from\" param for drag and drop');\r\n    assert(to, 'missing \"to\" param for drag and drop');\r\n    await page.mouse.drag(\r\n      {\r\n        x: from.center[0],\r\n        y: from.center[1],\r\n      },\r\n      {\r\n        x: to.center[0],\r\n        y: to.center[1],\r\n      },\r\n    );\r\n  }),\r\n\r\n  defineActionLongPress(async (param) => {\r\n    const element = param.locate;\r\n    assert(element, 'Element not found, cannot long press');\r\n    const duration = param?.duration;\r\n    await page.longPress(element.center[0], element.center[1], duration);\r\n  }),\r\n\r\n  defineActionSwipe(async (param) => {\r\n    const { width, height } = await page.size();\r\n    const { start, end } = param;\r\n\r\n    const startPoint = start\r\n      ? {\r\n          x: start.center[0],\r\n          y: start.center[1],\r\n        }\r\n      : {\r\n          x: width / 2,\r\n          y: height / 2,\r\n        };\r\n\r\n    let endPoint: {\r\n      x: number;\r\n      y: number;\r\n    };\r\n\r\n    if (end) {\r\n      endPoint = {\r\n        x: end.center[0],\r\n        y: end.center[1],\r\n      };\r\n    } else if (param.distance) {\r\n      const direction = param.direction;\r\n      if (!direction) {\r\n        throw new Error('direction is required for swipe gesture');\r\n      }\r\n\r\n      endPoint = {\r\n        x:\r\n          startPoint.x +\r\n          (direction === 'right'\r\n            ? param.distance\r\n            : direction === 'left'\r\n              ? -param.distance\r\n              : 0),\r\n        y:\r\n          startPoint.y +\r\n          (direction === 'down'\r\n            ? param.distance\r\n            : direction === 'up'\r\n              ? -param.distance\r\n              : 0),\r\n      };\r\n    } else {\r\n      throw new Error(\r\n        'Either end or distance must be specified for swipe gesture',\r\n      );\r\n    }\r\n\r\n    // Ensure end coordinates are within bounds\r\n    endPoint.x = Math.max(0, Math.min(endPoint.x, width));\r\n    endPoint.y = Math.max(0, Math.min(endPoint.y, height));\r\n\r\n    const duration = param.duration;\r\n\r\n    debug(\r\n      `swipe from ${startPoint.x}, ${startPoint.y} to ${endPoint.x}, ${endPoint.y} with duration ${duration}ms, repeat is set to ${param.repeat}`,\r\n    );\r\n    let repeat = typeof param.repeat === 'number' ? param.repeat : 1;\r\n    if (repeat === 0) {\r\n      repeat = 10; // 10 times is enough for infinite swipe\r\n    }\r\n    for (let i = 0; i < repeat; i++) {\r\n      await page.swipe(startPoint, endPoint, duration);\r\n    }\r\n  }),\r\n\r\n  defineActionClearInput(async (param) => {\r\n    const element = param.locate;\r\n    assert(element, 'Element not found, cannot clear input');\r\n    await page.clearInput(element as unknown as ElementInfo);\r\n  }),\r\n];\r\n"],"names":["__webpack_require__","module","getter","definition","key","Object","obj","prop","Symbol","debug","getDebug","normalizeKeyInputs","value","inputs","Array","result","input","trimmed","normalized","transformed","transformHotkeyInput","getKeyCommands","keys","acc","k","includeMeta","AbstractWebPage","AbstractInterface","x","y","options","deltaX","deltaY","from","to","text","action","element","commonWebActionsForWebPage","page","defineActionTap","param","assert","defineActionRightClick","defineActionDoubleClick","defineActionHover","defineActionInput","defineActionKeyboardPress","defineActionScroll","startingPoint","undefined","scrollToEventName","Error","JSON","sleep","defineActionDragAndDrop","defineActionLongPress","duration","defineActionSwipe","width","height","start","end","startPoint","endPoint","direction","Math","repeat","i","defineActionClearInput"],"mappings":"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"}