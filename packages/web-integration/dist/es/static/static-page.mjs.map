{"version":3,"file":"static\\static-page.mjs","sources":["webpack://@sqaitech/web/./src/static/static-page.ts"],"sourcesContent":["import type { DeviceAction, Point, UIContext } from '@sqaitech/core';\r\nimport type { AbstractInterface } from '@sqaitech/core/device';\r\nimport {\r\n  defineActionDragAndDrop,\r\n  defineActionHover,\r\n  defineActionInput,\r\n  defineActionKeyboardPress,\r\n  defineActionRightClick,\r\n  defineActionScroll,\r\n  defineActionTap,\r\n} from '@sqaitech/core/device';\r\nimport { ERROR_CODE_NOT_IMPLEMENTED_AS_DESIGNED } from '@sqaitech/shared/common';\r\n\r\ntype WebUIContext = UIContext & {\r\n  screenshotBase64?: string;\r\n  size: { width: number; height: number; dpr?: number };\r\n};\r\n\r\nconst ThrowNotImplemented = (methodName: string) => {\r\n  throw new Error(\r\n    `The method \"${methodName}\" is not implemented as designed since this is a static UI context. (${ERROR_CODE_NOT_IMPLEMENTED_AS_DESIGNED})`,\r\n  );\r\n};\r\n\r\nexport default class StaticPage implements AbstractInterface {\r\n  interfaceType = 'static';\r\n\r\n  private uiContext: WebUIContext;\r\n\r\n  constructor(uiContext: WebUIContext) {\r\n    if (uiContext.tree) {\r\n      this.uiContext = uiContext;\r\n    } else {\r\n      this.uiContext = Object.assign(uiContext, {\r\n        tree: {\r\n          node: null,\r\n          children: [],\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  actionSpace(): DeviceAction[] {\r\n    // Return available actions for static page - they will throw \"not implemented\" errors when executed\r\n    // but need to be available for planning phase\r\n    return [\r\n      defineActionTap(async (param) => {\r\n        ThrowNotImplemented('Tap');\r\n      }),\r\n      defineActionRightClick(async (param) => {\r\n        ThrowNotImplemented('RightClick');\r\n      }),\r\n      defineActionHover(async (param) => {\r\n        ThrowNotImplemented('Hover');\r\n      }),\r\n      defineActionInput(async (param) => {\r\n        ThrowNotImplemented('Input');\r\n      }),\r\n      defineActionKeyboardPress(async (param) => {\r\n        ThrowNotImplemented('KeyboardPress');\r\n      }),\r\n      defineActionScroll(async (param) => {\r\n        ThrowNotImplemented('Scroll');\r\n      }),\r\n      defineActionDragAndDrop(async (param) => {\r\n        ThrowNotImplemented('DragAndDrop');\r\n      }),\r\n    ];\r\n  }\r\n\r\n  async evaluateJavaScript<T = unknown>(script: string): Promise<T> {\r\n    return ThrowNotImplemented('evaluateJavaScript');\r\n  }\r\n\r\n  // @deprecated\r\n  async getElementsInfo() {\r\n    return ThrowNotImplemented('getElementsInfo');\r\n  }\r\n\r\n  async getElementsNodeTree() {\r\n    return ThrowNotImplemented('getElementsNodeTree');\r\n  }\r\n\r\n  async getXpathsById(id: string) {\r\n    return ThrowNotImplemented('getXpathsById');\r\n  }\r\n\r\n  async getXpathsByPoint(point: Point) {\r\n    return ThrowNotImplemented('getXpathsByPoint');\r\n  }\r\n\r\n  async getElementInfoByXpath(xpath: string) {\r\n    return ThrowNotImplemented('getElementInfoByXpath');\r\n  }\r\n\r\n  async size() {\r\n    return {\r\n      ...this.uiContext.size,\r\n      dpr: this.uiContext.size.dpr || 1,\r\n    };\r\n  }\r\n\r\n  async screenshotBase64() {\r\n    const base64 = this.uiContext.screenshotBase64;\r\n    if (!base64) {\r\n      throw new Error('screenshot base64 is empty');\r\n    }\r\n    return base64;\r\n  }\r\n\r\n  async url() {\r\n    return Promise.resolve('https://static_page_without_url');\r\n  }\r\n\r\n  async scrollUntilTop(startingPoint?: Point) {\r\n    return ThrowNotImplemented('scrollUntilTop');\r\n  }\r\n\r\n  async scrollUntilBottom(startingPoint?: Point) {\r\n    return ThrowNotImplemented('scrollUntilBottom');\r\n  }\r\n\r\n  async scrollUntilLeft(startingPoint?: Point) {\r\n    return ThrowNotImplemented('scrollUntilLeft');\r\n  }\r\n\r\n  async scrollUntilRight(startingPoint?: Point) {\r\n    return ThrowNotImplemented('scrollUntilRight');\r\n  }\r\n\r\n  async scrollUp(distance?: number, startingPoint?: Point) {\r\n    return ThrowNotImplemented('scrollUp');\r\n  }\r\n\r\n  async scrollDown(distance?: number, startingPoint?: Point) {\r\n    return ThrowNotImplemented('scrollDown');\r\n  }\r\n\r\n  async scrollLeft(distance?: number, startingPoint?: Point) {\r\n    return ThrowNotImplemented('scrollLeft');\r\n  }\r\n\r\n  async scrollRight(distance?: number, startingPoint?: Point) {\r\n    return ThrowNotImplemented('scrollRight');\r\n  }\r\n\r\n  async clearInput() {\r\n    return ThrowNotImplemented('clearInput');\r\n  }\r\n\r\n  mouse = {\r\n    click: ThrowNotImplemented.bind(null, 'mouse.click'),\r\n    wheel: ThrowNotImplemented.bind(null, 'mouse.wheel'),\r\n    move: ThrowNotImplemented.bind(null, 'mouse.move'),\r\n    drag: ThrowNotImplemented.bind(null, 'mouse.drag'),\r\n  };\r\n\r\n  keyboard = {\r\n    type: ThrowNotImplemented.bind(null, 'keyboard.type'),\r\n    press: ThrowNotImplemented.bind(null, 'keyboard.press'),\r\n  };\r\n\r\n  async destroy(): Promise<void> {\r\n    //\r\n  }\r\n\r\n  async getContext(): Promise<UIContext> {\r\n    return this.uiContext;\r\n  }\r\n\r\n  updateContext(newContext: WebUIContext): void {\r\n    this.uiContext = newContext;\r\n  }\r\n}\r\n"],"names":["ThrowNotImplemented","methodName","Error","ERROR_CODE_NOT_IMPLEMENTED_AS_DESIGNED","StaticPage","defineActionTap","param","defineActionRightClick","defineActionHover","defineActionInput","defineActionKeyboardPress","defineActionScroll","defineActionDragAndDrop","script","id","point","xpath","base64","Promise","startingPoint","distance","newContext","uiContext","Object"],"mappings":"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"}