{"version":3,"file":"agent\\ui-utils.mjs","sources":["webpack://@sqai/core/./src/agent/ui-utils.ts"],"sourcesContent":["import type {\r\n  AndroidPullParam,\r\n  DetailedLocateParam,\r\n  ExecutionTask,\r\n  ExecutionTaskAction,\r\n  ExecutionTaskInsightAssertion,\r\n  ExecutionTaskInsightLocate,\r\n  ExecutionTaskInsightQuery,\r\n  ExecutionTaskPlanning,\r\n  ScrollParam,\r\n} from '@/types';\r\n\r\nexport function typeStr(task: ExecutionTask) {\r\n  return task.subType && task.subType !== 'Plan'\r\n    ? `${task.type} / ${task.subType || ''}`\r\n    : task.type;\r\n}\r\n\r\nexport function locateParamStr(locate?: DetailedLocateParam | string): string {\r\n  if (!locate) {\r\n    return '';\r\n  }\r\n\r\n  if (typeof locate === 'string') {\r\n    return locate;\r\n  }\r\n\r\n  if (typeof locate === 'object') {\r\n    if (typeof locate.prompt === 'string') {\r\n      return locate.prompt;\r\n    }\r\n\r\n    if (typeof locate.prompt === 'object' && locate.prompt.prompt) {\r\n      const prompt = locate.prompt.prompt;\r\n      const images = locate.prompt.images || [];\r\n\r\n      if (images.length === 0) return prompt;\r\n\r\n      const imagesStr = images\r\n        .map((image) => {\r\n          let url = image.url;\r\n          if (\r\n            url.startsWith('data:image/') ||\r\n            (url.startsWith('data:') && url.includes('base64'))\r\n          ) {\r\n            url = `${url.substring(0, 15)}...`;\r\n          }\r\n          return `[${image.name}](${url})`;\r\n        })\r\n        .join(', ');\r\n\r\n      return `${prompt}, ${imagesStr}`;\r\n    }\r\n  }\r\n\r\n  return '';\r\n}\r\n\r\nexport function scrollParamStr(scrollParam?: ScrollParam) {\r\n  if (!scrollParam) {\r\n    return '';\r\n  }\r\n  return `${scrollParam.direction || 'down'}, ${scrollParam.scrollType || 'once'}, ${scrollParam.distance || 'distance-not-set'}`;\r\n}\r\n\r\nexport function pullParamStr(pullParam?: AndroidPullParam) {\r\n  if (!pullParam) {\r\n    return '';\r\n  }\r\n  const parts: string[] = [];\r\n  parts.push(`direction: ${pullParam.direction || 'down'}`);\r\n  if (pullParam.distance) {\r\n    parts.push(`distance: ${pullParam.distance}`);\r\n  }\r\n  if (pullParam.duration) {\r\n    parts.push(`duration: ${pullParam.duration}ms`);\r\n  }\r\n  return parts.join(', ');\r\n}\r\n\r\nexport function taskTitleStr(\r\n  type:\r\n    | 'Tap'\r\n    | 'Hover'\r\n    | 'Input'\r\n    | 'RightClick'\r\n    | 'KeyboardPress'\r\n    | 'Scroll'\r\n    | 'Action'\r\n    | 'Query'\r\n    | 'Assert'\r\n    | 'WaitFor'\r\n    | 'Locate'\r\n    | 'Boolean'\r\n    | 'Number'\r\n    | 'String',\r\n  prompt: string,\r\n) {\r\n  if (prompt) {\r\n    return `${type} - ${prompt}`;\r\n  }\r\n  return type;\r\n}\r\n\r\nexport function paramStr(task: ExecutionTask) {\r\n  let value: string | undefined | object;\r\n  if (task.type === 'Planning') {\r\n    value = (task as ExecutionTaskPlanning)?.param?.userInstruction;\r\n  }\r\n\r\n  if (task.type === 'Insight') {\r\n    value =\r\n      locateParamStr((task as ExecutionTaskInsightLocate)?.param) ||\r\n      (task as ExecutionTaskInsightLocate)?.param?.id ||\r\n      (task as ExecutionTaskInsightQuery)?.param?.dataDemand ||\r\n      (task as ExecutionTaskInsightAssertion)?.param?.assertion;\r\n  }\r\n\r\n  if (task.type === 'Action') {\r\n    const locate = (task as ExecutionTaskAction)?.locate;\r\n    const locateStr = locate ? locateParamStr(locate) : '';\r\n\r\n    value = task.thought || '';\r\n    if (typeof (task as ExecutionTaskAction)?.param?.timeMs === 'number') {\r\n      value = `${(task as ExecutionTaskAction)?.param?.timeMs}ms`;\r\n    } else if (\r\n      typeof (task as ExecutionTaskAction)?.param?.scrollType === 'string'\r\n    ) {\r\n      value = scrollParamStr((task as ExecutionTaskAction)?.param);\r\n    } else if (\r\n      typeof (task as ExecutionTaskAction)?.param?.direction === 'string' &&\r\n      (task as ExecutionTaskAction)?.subType === 'AndroidPull'\r\n    ) {\r\n      value = pullParamStr((task as ExecutionTaskAction)?.param);\r\n    } else if (\r\n      typeof (task as ExecutionTaskAction)?.param?.value !== 'undefined'\r\n    ) {\r\n      value = (task as ExecutionTaskAction)?.param?.value;\r\n    }\r\n\r\n    if (locateStr) {\r\n      if (value) {\r\n        value = `${locateStr} - ${value}`;\r\n      } else {\r\n        value = locateStr;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (typeof value === 'undefined') return '';\r\n\r\n  if (typeof value === 'string') return value;\r\n\r\n  if (typeof value === 'object' && locateParamStr(value as any)) {\r\n    return locateParamStr(value as any);\r\n  }\r\n\r\n  return JSON.stringify(value, undefined, 2);\r\n}\r\n"],"names":["typeStr","task","locateParamStr","locate","prompt","images","imagesStr","image","url","scrollParamStr","scrollParam","pullParamStr","pullParam","parts","taskTitleStr","type","paramStr","value","_task_param","_task_param1","_task_param2","_task_param3","_task_param4","_task_param5","_task_param6","_task_param7","locateStr","_task_param8","_task_param9","JSON","undefined"],"mappings":"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"}